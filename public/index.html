<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Nodevision</title>

  <!-- Nodevision is a digital notebook system created by Henry Holben using code generated by ChatGPT -->
  <link rel="stylesheet" href="style.css">

  <!-- Include the Cytoscape.js library -->
  <script src="https://unpkg.com/cytoscape/dist/cytoscape.min.js"></script>

  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML">
  </script>

  <script src="https://unpkg.com/layout-base/layout-base.js"></script>
  <script src="https://unpkg.com/cose-base/cose-base.js"></script>
  <script src="https://unpkg.com/cytoscape-fcose/cytoscape-fcose.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/cytoscape/3.29.2/cytoscape.min.js"></script>
  <!--<script src="https://unpkg.com/cytoscape-elk/cytoscape-elk.js"></script>-->
  <script src="GeneratedNodes.js" defer></script>
  <script src="GeneratedEdges.js" defer></script>
  <script src="GeneratedRegions.js" defer></script>
  <script src="Graph.js" defer></script>

  <style>
    body {
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    #settings-section {
      width: 100%;
      margin-bottom: 20px;
    }
    #content {
      display: flex;
      width: 90%;
    }
    #cy {
      flex: 1;
      height: 600px;
      border: 1px solid #ccc;
      margin-right: 20px;
    }
    #info-panel {
      width: 300px;
    }
    #content-frame-container {
      resize: both;
      overflow: auto;
    }
  </style>
</head>
<body>
  <div id="settings-section">
    <h3>Set number of elements:</h3>
    <label for="maxNodes">Maximum Nodes Displayed:</label>
    <input type="number" id="maxNodes" name="maxNodes" value="100">
    <button onclick="setMaximumNodesDisplayed()">Set Maximum Nodes</button>
    <br>
    <label for="maxRegions">Maximum Regions Displayed:</label>
    <input type="number" id="maxRegions" name="maxRegions" value="100">
    <button onclick="setMaximumRegionsDisplayed()">Set Maximum Regions</button>
    <br>
    <label for="maxEdges">Maximum Edges Displayed:</label>
    <input type="number" id="maxEdges" name="maxEdges" value="100">
    <button onclick="setMaximumEdgesDisplayed()">Set Maximum Edges</button>
    <br>
    <button onclick="regenerateFiles()">Regenerate Files</button>
    
    <!-- Button to navigate to SettingsPage.html -->
    <button onclick="navigateToSettings()">Settings Page</button>
    <br>
  </div>

  <div id="content">
    <div id="cy"></div>
    <div id="info-panel">
      <h3>Selected Element Info</h3>

      <div id="content-frame-container">
        <iframe id="content-frame" height="200" width="100%" src="" style="resize: both; overflow: auto;"></iframe>
      </div>

      <div id="element-info">Click on a node, edge, or region to see details.</div>
      <div id="info-buttons">
        <button id="edit-button" class="info-button">Edit</button>
        <button id="new-button" class="info-button">New</button>
        <button id="open-button" class="info-button">Open</button>
      </div>
    </div>
  </div>

  <!-- Script to navigate to SettingsPage.html -->
  <script>
    function navigateToSettings() {
      window.location.href = 'SettingsPage.html';
    }

    function setMaximumNodesDisplayed() {
      const maxNodes = parseInt(document.getElementById('maxNodes').value, 10);
      fetch('/set-max-nodes', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ maxNodes })
      })
      .then(response => response.json())
      .then(data => {
        console.log(data.message);
        // Optionally trigger regeneration of files
      })
      .catch(error => console.error('Error:', error));
    }

    function setMaximumRegionsDisplayed() {
      const maxRegions = parseInt(document.getElementById('maxRegions').value, 10);
      fetch('/set-max-regions', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ maxRegions })
      })
      .then(response => response.json())
      .then(data => {
        console.log(data.message);
        // Optionally trigger regeneration of files
      })
      .catch(error => console.error('Error:', error));
    }

    function setMaximumEdgesDisplayed() {
      const maxEdges = parseInt(document.getElementById('maxEdges').value, 10);
      fetch('/set-max-edges', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ maxEdges })
      })
      .then(response => response.json())
      .then(data => {
        console.log(data.message);
        // Optionally trigger regeneration of files
      })
      .catch(error => console.error('Error:', error));
    }

    function regenerateFiles() {
      fetch('/regenerate-files', { method: 'POST' })
        .then(response => response.json())
        .then(data => console.log(data.message))
        .catch(error => console.error('Error:', error));
    }

    // Make the content frame expandable
    document.getElementById('content-frame').addEventListener('click', function() {
      this.style.height = (this.style.height === '100%') ? '200px' : '100%';
      this.style.width = (this.style.width === '100%') ? '100%' : '100%';
    });
  </script>
</body>
</html>
